import{_ as N,S as j,u as k,s as H,g as v,v as F,D as E,e as n,o as f,c as y,a as o,f as i,w as d,F as R,h as c,t as h,n as _,i as S,x as L,y as A,p as J,j as Y}from"./index.d664afa4.js";import{_ as O,M as K}from"./PickBarang.c64728d9.js";import{_ as z}from"./nurse.4d4e2e4c.js";const W={components:{StreamBarcodeReader:j,PickBarang:O},data(){return{categories:{category:[],nama_Masuk:[]},products:null,productDialog:!1,deleteProductDialog:!1,deleteProductsDialog:!1,product:{},selectedProducts:null,filters:{},checkedHargaBaru:!1,submitted:!1,mode_edit:"Edit",pickCategoryModel:null,pickMasukModel:null,modeEdit:"",store:k(),barcodeDialog:!1,filteredData:null,menuPickBarang:[{label:"Pilih Barang",icon:"pi pi-upload",command:this.onPickBarang},{label:"Input Barang Baru",icon:"pi pi-upload",command:()=>{k().globalEvent.newInputBarang=!0,this.$router.push({path:"/data-barang"})}}]}},productService:null,created(){this.productService=new K,this.initFilters()},mounted(){this.productService.getMasuks().then(s=>{this.products=s,console.log("stokmasuk",this.products)})},methods:{onPickBarang(){this.$emitter.emit("pick-barang-dialog",{visible:!0})},formatCurrency(s){if(s){var e=new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"});return e.format(s)}},changePickCategory(){this.product.id_category=this.pickCategoryModel.value,this.product.category=this.pickCategoryModel.label},changePickMasuk(){this.product.id_Masuk=this.pickMasukModel.value,this.product.nama_Masuk=this.pickMasukModel.label},openNew(){this.modeEdit="new",this.product={},this.product.user_id=this.productService.getUserId(),this.submitted=!1,this.mode_edit="- Baru",this.productDialog=!0},hideDialog(){this.productDialog=!1,this.submitted=!1},validate(){return this.product.tgl_masuk=H(this.product.tgl_masuk).format("YYYY-MM-DD"),console.log("validate",this.product.tgl_masuk),this.product.id_category&&this.product.category&&this.product.tgl_masuk&&this.product.id_barang&&this.product.nama_barang&&this.product.user_id&&this.product.jumlah&&this.product.sub_id&&this.product.keterangan},async saveProduct(){if(console.log("save",this.product),this.submitted=!0,this.validate())if(this.modeEdit=="new"){if(this.checkedHargaBaru){console.log("hb",this.product);let s={id_category:this.product.id_category,category:this.product.category,barcode:this.product.barcode,id_barang:this.product.id_barang,nama_barang:this.product.nama_barang,uraian:this.product.uraian,stok:0,satuan:this.product.satuan,harga_satuan:this.product.harga_satuan},e=await this.productService.saveHargaBaru(s);this.product.sub_id=await e.sub_id,this.$toast.add({severity:"success",summary:"Successful",detail:"Barang harga baru added",life:3e3}),console.log("hb",e)}else{let s={id:this.product.id_barang_stok,id_category:this.product.id_category,category:this.product.category,barcode:this.product.barcode,id_barang:this.product.id_barang,nama_barang:this.product.nama_barang,uraian:this.product.uraian,satuan:this.product.satuan,harga_satuan:this.product.harga_satuan};console.log("barangedit",s),this.productService.updateBarang(s).then(e=>{console.log("save barang edit",e),this.$toast.add({severity:"success",summary:"Successful",detail:"Barang Updated",life:3e3})})}this.productService.saveMasuk(this.product,!0).then(s=>{console.log("save",s),this.$toast.add({severity:"success",summary:"Successful",detail:"Product Updated",life:3e3}),this.productService.getMasuks().then(e=>{this.products=e}),this.productDialog=!1,this.product={}})}else this.productService.saveMasuk(this.product,!1).then(s=>{console.log("save edit",s),this.$toast.add({severity:"success",summary:"Successful",detail:"Product Updated",life:3e3});let e={id:this.product.id_barang_stok,id_category:this.product.id_category,category:this.product.category,barcode:this.product.barcode,id_barang:this.product.id_barang,nama_barang:this.product.nama_barang,uraian:this.product.uraian,satuan:this.product.satuan,harga_satuan:this.product.harga_satuan};console.log("barangedit",e),this.productService.updateBarang(e).then(r=>{console.log("save barang edit",r),this.$toast.add({severity:"success",summary:"Successful",detail:"Barang Updated",life:3e3})}),this.productService.getMasuks().then(r=>{this.products=r}),this.productDialog=!1,this.product={}});else this.$toast.add({severity:"error",summary:"Error saving",detail:"Coba cek isiannya.",life:3e3}),console.log(this.product)},async editProduct(s){console.log("edit",s),this.modeEdit="edit",this.product={...s},this.product.user_id=this.productService.getUserId(),this.product.id_barang_stok=await this.productService.getBarangId(btoa(s.sub_id)),this.mode_edit="- Edit",this.productDialog=!0},confirmDeleteProduct(s){this.product=s,this.deleteProductDialog=!0},deleteProduct(){this.productService.deleteMasuk(this.product.id).then(s=>{console.log("del",s),this.deleteProductDialog=!1,this.product={},this.$toast.add({severity:"success",summary:"Successful",detail:"Product Deleted",life:3e3}),this.productService.getMasuks().then(e=>{this.products=e})})},findIndexById(s){let e=-1;for(let r=0;r<this.products.length;r++)if(this.products[r].id===s){e=r;break}return e},createId(){let s="";for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=0;r<5;r++)s+=e.charAt(Math.floor(Math.random()*e.length));return s},exportCSV(){this.$refs.dt.exportCSV()},confirmDeleteSelected(){this.deleteProductsDialog=!0},deleteSelectedProducts(){let s=this.selectedProducts.map(e=>this.productService.deleteMasuk(e.id));Promise.all(s).then(e=>{console.log(e),this.productService.getMasuks().then(r=>{this.products=r,this.deleteProductsDialog=!1,this.selectedProducts=null,this.$toast.add({severity:"success",summary:"Successful",detail:"Products Deleted",life:3e3})})})},initFilters(){this.filters={global:{value:null,matchMode:v.CONTAINS},category:{operator:F.AND,constraints:[{value:null,matchMode:v.STARTS_WITH}]}}},print_stok_masuk(){this.$dialog.open(E,{props:{header:"Print Stok Masuk",style:{width:"80vw"},breakpoints:{"960px":"80vw","640px":"90vw"},modal:!0},data:{type:"print-stok-masuk"},templates:{},onClose:s=>{s.data}})},onFiltered(s){this.filteredData=s},scanNOW(){navigator&&navigator.mediaDevices&&"enumerateDevices"in navigator.mediaDevices?(this.barcodeDialog=!0,console.log("yes")):(console.log("no"),this.$toast.add({severity:"error",summary:"Barcode not supported",detail:"Silakan coba akses dari HP/address via https",life:3e3}),this.barcodeDialog=!1)},onDecodeBarcode(s){this.barcodeDialog=!1,this.product.barcode=s,this.productService.getBarangByBarcode(s).then(e=>{this.product.id_barang_stok=e.id,this.product.id_category=e.id_category,this.product.category=e.category,this.product.id_barang=e.id_barang,this.product.nama_barang=e.nama_barang,this.product.uraian=e.uraian,this.product.satuan=e.satuan,this.product.harga_satuan=e.harga_satuan,this.product.sub_id=e.sub_id})},actionSelectedPickBarang(s){console.log(s),this.product.id_barang_stok=s.id,this.product.id_category=s.id_category,this.product.category=s.category,this.product.id_barang=s.id_barang,this.product.nama_barang=s.nama_barang,this.product.uraian=s.uraian,this.product.satuan=s.satuan,this.product.harga_satuan=s.harga_satuan,this.product.sub_id=s.sub_id,this.product.barcode=s.barcode}}},l=s=>(J("data-v-4a45aded"),s=s(),Y(),s),q={class:"grid"},G={class:"col-12"},Q={class:"card"},X={class:"my-2"},Z={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},$=l(()=>o("h5",{class:"m-0"},"Manage Stok Masuk",-1)),ee={class:"block mt-2 md:mt-0 p-input-icon-left"},te=l(()=>o("i",{class:"pi pi-search"},null,-1)),ae=l(()=>o("img",{width:"32",src:z},null,-1)),oe=l(()=>o("span",{class:"p-column-title"},"User ID",-1)),se=l(()=>o("span",{class:"p-column-title"},"Tgl Masuk",-1)),ie=l(()=>o("span",{class:"p-column-title"},"Category",-1)),le=l(()=>o("span",{class:"p-column-title"},"Jenis Barang",-1)),de=l(()=>o("span",{class:"p-column-title"},"SUB ID",-1)),re=l(()=>o("span",{class:"p-column-title"},"Barcode",-1)),ne=l(()=>o("span",{class:"p-column-title"},"Uraian",-1)),ue=l(()=>o("span",{class:"p-column-title"},"Jumlah",-1)),ce=l(()=>o("span",{class:"p-column-title"},"Satuan",-1)),pe=l(()=>o("span",{class:"p-column-title"},"Harga Satuan",-1)),he=l(()=>o("span",{class:"p-column-title"},"Keterangan",-1)),me={class:"grid"},ge={class:"field col-12 md:col-6"},_e={class:"grid"},be={class:"field col-8"},fe=l(()=>o("label",{for:"tgl_masuk"},"Tanggal Masuk",-1)),ye={class:"field col-4"},ke=l(()=>o("label",null,"Pilih/Input Barang",-1)),ve={class:"grid col-12 md:col-6"},Se={class:"field col-8"},De=l(()=>o("label",{for:"barcode"},"Barcode",-1)),Pe={class:"field col-4"},we=l(()=>o("label",null,"Scan via HP",-1)),Ce={class:"grid"},Me={class:"field col-6 md:col-6"},Ve=l(()=>o("label",{for:"idCategory"},"ID Category",-1)),xe={class:"field col-6 md:col-6"},Be=l(()=>o("label",{for:"category"},"Kategori",-1)),Ue={class:"field col-6 md:col-4"},Ie=l(()=>o("label",{for:"subidbarang"},"Sub ID",-1)),Te={class:"field col-6 md:col-4"},Ne=l(()=>o("label",{for:"idbarang"},"ID Barang",-1)),je={class:"field col-6 md:col-4"},He=l(()=>o("label",{for:"barang"},"Jenis Barang",-1)),Fe={class:"field col-6 md:col-6"},Ee=l(()=>o("label",{for:"uraian"},"Uraian",-1)),Re={class:"field col-6 md:col-6"},Le={class:"field-checkbox justify-content-between mb-0"},Ae=l(()=>o("label",{for:"hargasatuan"},"Harga Satuan",-1)),Je=l(()=>o("label",{for:"binary",class:"ml-3"},"*Harga baru",-1)),Ye={class:"field col-6 md:col-6"},Oe=l(()=>o("label",{for:"jumlah"},"Jumlah Masuk",-1)),Ke={class:"field col-6 md:col-6"},ze=l(()=>o("label",{for:"stok"},"Satuan",-1)),We={class:"field col-12"},qe=l(()=>o("label",{for:"keterangan"},"Keterangan",-1)),Ge={class:"flex align-items-center justify-content-center"},Qe=l(()=>o("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),Xe={key:0},Ze=c("Anda yakin menghapus "),$e=c("?"),et={class:"flex align-items-center justify-content-center"},tt=l(()=>o("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),at={key:0};function ot(s,e,r,st,t,u){const D=n("Toast"),m=n("Button"),P=n("Toolbar"),g=n("InputText"),p=n("Column"),w=n("DataTable"),C=n("Calendar"),M=n("SplitButton"),V=n("Checkbox"),x=n("InputNumber"),b=n("Dialog"),B=n("StreamBarcodeReader"),U=n("PickBarang"),I=n("DynamicDialog");return f(),y(R,null,[o("div",q,[o("div",G,[o("div",Q,[i(D),i(P,{class:"mb-4"},{start:d(()=>[o("div",X,[i(m,{label:"New",icon:"pi pi-plus",class:"p-button-success mr-2",disabled:t.store.login.data.role=="user",onClick:u.openNew},null,8,["disabled","onClick"])])]),end:d(()=>[i(m,{label:"Print",icon:"pi pi-print",class:"p-button-success mr-2",onClick:e[0]||(e[0]=a=>u.print_stok_masuk())})]),_:1}),i(w,{ref:"dt",value:t.products,selection:t.selectedProducts,"onUpdate:selection":e[2]||(e[2]=a=>t.selectedProducts=a),dataKey:"id",paginator:!0,rows:10,filters:t.filters,"onUpdate:filters":e[3]||(e[3]=a=>t.filters=a),responsiveLayout:"scroll",filterDisplay:"menu",paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} products",onValueChange:u.onFiltered},{header:d(()=>[o("div",Z,[$,o("span",ee,[te,i(g,{modelValue:t.filters.global.value,"onUpdate:modelValue":e[1]||(e[1]=a=>t.filters.global.value=a),placeholder:"Search..."},null,8,["modelValue"])])])]),default:d(()=>[i(p,{field:"email",header:"User ID",sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:d(a=>[ae,oe,c(" "+h(a.data.email),1)]),_:1}),i(p,{field:"tgl_masuk",header:"Tgl Masuk",sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:d(a=>[se,c(" "+h(new Date(a.data.tgl_masuk).toLocaleDateString("ID-id")),1)]),_:1}),i(p,{field:"category",header:"Category",sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:d(a=>[ie,c(" "+h(a.data.category),1)]),_:1}),i(p,{field:"nama_barang",header:"Jenis Barang",sortable:!0,headerStyle:"width:14%; min-width:8rem;"},{body:d(a=>[le,c(" "+h(a.data.nama_barang),1)]),_:1}),i(p,{field:"sub_id",header:"SUB ID",sortable:!0,headerStyle:"width:14%; min-width:8rem;"},{body:d(a=>[de,c(" "+h(a.data.sub_id),1)]),_:1}),i(p,{field:"barcode",header:"Barcode",sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:d(a=>[re,c(" "+h(a.data.barcode),1)]),_:1}),i(p,{field:"uraian",header:"Uraian",sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:d(a=>[ne,c(" "+h(a.data.uraian),1)]),_:1}),i(p,{field:"jumlah",header:"Jumlah",sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:d(a=>[ue,c(" "+h(a.data.jumlah),1)]),_:1}),i(p,{field:"satuan",header:"Satuan",sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:d(a=>[ce,c(" "+h(a.data.satuan),1)]),_:1}),i(p,{field:"harga_satuan",header:"Harga Satuan",sortable:!0,dataType:"numeric",headerStyle:"width:14%; min-width:10rem;"},{body:d(a=>[pe,c(" "+h(u.formatCurrency(a.data.harga_satuan)),1)]),_:1}),i(p,{field:"keterangan",header:"keterangan",sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:d(a=>[he,c(" "+h(a.data.keterangan),1)]),_:1}),i(p,{headerStyle:"min-width:10rem;"},{body:d(a=>[i(m,{icon:"pi pi-pencil",class:"p-button-rounded p-button-success mr-2",onClick:T=>u.editProduct(a.data),disabled:t.store.login.data.role=="user"},null,8,["onClick","disabled"]),i(m,{icon:"pi pi-trash",class:"p-button-rounded p-button-warning mt-2",onClick:T=>u.confirmDeleteProduct(a.data),disabled:t.store.login.data.role=="user"},null,8,["onClick","disabled"])]),_:1})]),_:1},8,["value","selection","filters","onValueChange"]),i(b,{visible:t.productDialog,"onUpdate:visible":e[17]||(e[17]=a=>t.productDialog=a),style:{width:"1024px"},header:`Stok Masuk ${t.mode_edit}`,modal:!0,class:"p-fluid"},{footer:d(()=>[i(m,{label:"Cancel",icon:"pi pi-times",class:"p-button-text",onClick:u.hideDialog},null,8,["onClick"]),i(m,{label:"Save",icon:"pi pi-check",class:"p-button-text",onClick:u.saveProduct},null,8,["onClick"])]),default:d(()=>[o("div",me,[o("div",ge,[o("div",_e,[o("div",be,[fe,i(C,{class:_({"p-invalid":t.submitted&&!t.product.tgl_masuk}),id:"tgl_masuk",modelValue:t.product.tgl_masuk,"onUpdate:modelValue":e[4]||(e[4]=a=>t.product.tgl_masuk=a),dateFormat:"dd-mm-yy"},null,8,["class","modelValue"])]),o("div",ye,[ke,i(M,{label:"Pilih",model:t.menuPickBarang,class:"p-button-info p-button-raised mb-2"},null,8,["model"])])])]),o("div",ve,[o("div",Se,[De,i(g,{id:"barcode",modelValue:t.product.barcode,"onUpdate:modelValue":e[5]||(e[5]=a=>t.product.barcode=a),modelModifiers:{trim:!0},required:"false",autofocus:""},null,8,["modelValue"])]),o("div",Pe,[we,i(m,{label:"Scan",icon:"pi pi-search",class:"p-button-info",onClick:u.scanNOW},null,8,["onClick"])])])]),o("div",Ce,[o("div",Me,[Ve,i(g,{id:"idCategory",modelValue:t.product.id_category,"onUpdate:modelValue":e[6]||(e[6]=a=>t.product.id_category=a),modelModifiers:{trim:!0},disabled:"",autofocus:"",class:_(["disable-input",{"p-invalid":t.submitted&&!t.product.id_category}])},null,8,["modelValue","class"])]),o("div",xe,[Be,i(g,{id:"category",modelValue:t.product.category,"onUpdate:modelValue":e[7]||(e[7]=a=>t.product.category=a),modelModifiers:{trim:!0},disabled:"",autofocus:"",class:_(["disable-input",{"p-invalid":t.submitted&&!t.product.category}])},null,8,["modelValue","class"])]),o("div",Ue,[Ie,i(g,{id:"subidbarang",modelValue:t.product.sub_id,"onUpdate:modelValue":e[8]||(e[8]=a=>t.product.sub_id=a),modelModifiers:{trim:!0},disabled:"",autofocus:"",class:_(["disable-input",{"p-invalid":t.submitted&&!t.product.sub_id}])},null,8,["modelValue","class"])]),o("div",Te,[Ne,i(g,{id:"idbarang",modelValue:t.product.id_barang,"onUpdate:modelValue":e[9]||(e[9]=a=>t.product.id_barang=a),modelModifiers:{trim:!0},disabled:"",autofocus:"",class:_(["disable-input",{"p-invalid":t.submitted&&!t.product.id_barang}])},null,8,["modelValue","class"])]),o("div",je,[He,i(g,{id:"barang",modelValue:t.product.nama_barang,"onUpdate:modelValue":e[10]||(e[10]=a=>t.product.nama_barang=a),modelModifiers:{trim:!0},disabled:"",autofocus:"",class:_(["disable-input",{"p-invalid":t.submitted&&!t.product.nama_barang}])},null,8,["modelValue","class"])]),o("div",Fe,[Ee,i(g,{id:"uraian",modelValue:t.product.uraian,"onUpdate:modelValue":e[11]||(e[11]=a=>t.product.uraian=a),modelModifiers:{trim:!0},disabled:"",autofocus:"",class:_(["disable-input",{"p-invalid":t.submitted&&!t.product.uraian}])},null,8,["modelValue","class"])]),o("div",Re,[o("span",Le,[Ae,o("div",null,[i(V,{id:"binary",modelValue:t.checkedHargaBaru,"onUpdate:modelValue":e[12]||(e[12]=a=>t.checkedHargaBaru=a),binary:!0,disabled:t.modeEdit=="edit"},null,8,["modelValue","disabled"]),Je])]),i(g,{id:"hargasatuan",modelValue:t.product.harga_satuan,"onUpdate:modelValue":e[13]||(e[13]=a=>t.product.harga_satuan=a),modelModifiers:{trim:!0},autofocus:"",mode:"currency",currency:"IDR",locale:"id-ID",class:_({"p-invalid":t.submitted&&!t.product.harga_satuan})},null,8,["modelValue","class"])]),o("div",Ye,[Oe,i(x,{id:"jumlah",modelValue:t.product.jumlah,"onUpdate:modelValue":e[14]||(e[14]=a=>t.product.jumlah=a),integeronly:""},null,8,["modelValue"])]),o("div",Ke,[ze,i(g,{id:"satuan",modelValue:t.product.satuan,"onUpdate:modelValue":e[15]||(e[15]=a=>t.product.satuan=a),disabled:"",class:"disable-input"},null,8,["modelValue"])]),o("div",We,[qe,i(g,{id:"keterangan",modelValue:t.product.keterangan,"onUpdate:modelValue":e[16]||(e[16]=a=>t.product.keterangan=a),class:_({"p-invalid":t.submitted&&!t.product.harga_satuan})},null,8,["modelValue","class"])])])]),_:1},8,["visible","header"]),i(b,{visible:t.deleteProductDialog,"onUpdate:visible":e[19]||(e[19]=a=>t.deleteProductDialog=a),style:{width:"450px"},header:"Confirm",modal:!0},{footer:d(()=>[i(m,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:e[18]||(e[18]=a=>t.deleteProductDialog=!1)}),i(m,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:u.deleteProduct},null,8,["onClick"])]),default:d(()=>[o("div",Ge,[Qe,t.product?(f(),y("span",Xe,[Ze,o("b",null,h(t.product.uraian),1),$e])):S("",!0)])]),_:1},8,["visible"]),i(b,{visible:t.deleteProductsDialog,"onUpdate:visible":e[21]||(e[21]=a=>t.deleteProductsDialog=a),style:{width:"450px"},header:"Confirm",modal:!0},{footer:d(()=>[i(m,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:e[20]||(e[20]=a=>t.deleteProductsDialog=!1)}),i(m,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:u.deleteSelectedProducts},null,8,["onClick"])]),default:d(()=>[o("div",et,[tt,t.product?(f(),y("span",at,"Anda yakin menghapus Masuk yang terpilih?")):S("",!0)])]),_:1},8,["visible"]),i(b,{visible:t.barcodeDialog,"onUpdate:visible":e[22]||(e[22]=a=>t.barcodeDialog=a),style:{width:"450px"},header:"Scan",modal:!0},{default:d(()=>[L(o("div",null,[i(B,{onDecode:u.onDecodeBarcode},null,8,["onDecode"])],512),[[A,t.barcodeDialog]])]),_:1},8,["visible"])])])]),i(U,{onSelected:u.actionSelectedPickBarang},null,8,["onSelected"]),i(I)],64)}const rt=N(W,[["render",ot],["__scopeId","data-v-4a45aded"]]);export{rt as default};
